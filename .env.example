# Hail-Mary Docker Compose Environment Variables
# Copy this file to .env and fill in the values
# Note: This file is REQUIRED for docker-compose.yml to work properly

# ======================
# REQUIRED CONFIGURATION
# The application requires proper database credentials to start
# ======================

# ======================
# DATABASE (Required for docker-compose.yml)
# ======================
# PostgreSQL configuration
# CRITICAL: docker-compose.yml requires these to be set
# Generate a secure password with: node -e "console.log(require('crypto').randomBytes(16).toString('hex'))"
POSTGRES_USER=hailmary
POSTGRES_PASSWORD=YOUR_SECURE_PASSWORD_HERE
POSTGRES_DB=hailmary

# PostgreSQL connection URL
# IMPORTANT: Replace YOUR_SECURE_PASSWORD_HERE with the same password used in POSTGRES_PASSWORD above
DATABASE_URL=postgres://hailmary:YOUR_SECURE_PASSWORD_HERE@hailmary-postgres:5432/hailmary

# ======================
# SERVER PORTS (Optional - have working defaults)
# ======================
# API server port (default: 3001) - internal, not exposed
# PORT=3001

# Assistant server port (default: 3002) - internal, not exposed
# ASSISTANT_PORT=3002

# External port for PWA (default: 3000)
# This is the port you access in your browser
# Change if port 3000 is already in use
# PWA_PORT=3000

# ======================
# SECURITY (REQUIRED for production!)
# ======================
# JWT Secret for authentication tokens
# ðŸ”´ CRITICAL: This MUST be set to a secure random value in production!
# ðŸ”´ The application will NOT start if this is not set or uses the default value.
#
# Generate a secure secret with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# Example (DO NOT use this example value!):
# JWT_SECRET=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
#
# Without a secure JWT_SECRET, attackers can forge authentication tokens
# and gain unauthorized access, including admin accounts.
JWT_SECRET=

# CSRF Secret for CSRF protection
# ðŸ”´ CRITICAL: This MUST be set to a secure random value in production!
#
# Generate a secure secret with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# CSRF_SECRET=

# Admin Agent Token for system updates
# ðŸ”´ REQUIRED: This token is used to authenticate the admin agent service
# that handles system updates via Docker socket access.
#
# Generate a secure token with:
#   openssl rand -hex 32
#   OR: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# IMPORTANT: Replace the placeholder below with your own secure 64-character hex token!
ADMIN_AGENT_TOKEN=REPLACE_WITH_YOUR_SECURE_64_CHARACTER_HEX_TOKEN_HERE

# Base URL for password reset links (defaults to https://hail_mary.cloudbibb.uk)
# BASE_URL=https://hail_mary.cloudbibb.uk

# ======================
# AI ASSISTANT (Optional)
# ======================
# Gemini API key for AI assistant features
# Get your key from: https://aistudio.google.com/app/apikey
# GEMINI_API_KEY=your-gemini-api-key

# Gemini model to use (default: gemini-1.5-flash)
# Options include: gemini-1.5-flash, gemini-1.5-pro, gemini-2.0-flash
# GEMINI_MODEL=gemini-1.5-flash

# ======================
# TRANSCRIPTION & DEPOT NOTES (Optional)
# ======================
# OpenAI API key for Whisper transcription and GPT-4 structuring
# Get your key from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=your-openai-api-key

# Anthropic API key for Claude AI (fallback for depot notes structuring)
# Get your key from: https://console.anthropic.com/
# ANTHROPIC_API_KEY=your-anthropic-api-key

# Enable Whisper STT provider instead of mock (requires OPENAI_API_KEY)
# Default: false (uses mock provider)
# USE_WHISPER_STT=true

# ======================
# AI WORKER (Rocky & Sarah) - Optional
# ======================
# Worker URL for AI services (Rocky analysis + Sarah explanations)
# The API proxies requests to this Worker via /api/ai/* endpoints
# PWA must never call this URL directly - always use /api/ai/* endpoints
# Default: https://hail-mary.martinbibb.workers.dev
WORKER_URL=https://hail-mary.martinbibb.workers.dev

# ======================
# ROCKY (AI Analysis Engine) - Optional
# ======================
# Rocky is the AI-powered analysis engine for visit notes and observations.
# It uses Cloudflare Workers with Gemini (default), OpenAI, and Anthropic fallbacks.
# Rocky provides deterministic, structured analysis (no creativity).
# Endpoint: POST /rocky/analyse
#
# Cloudflare Worker URL for Rocky service (shared with Sarah)
# DEPRECATED: Use WORKER_URL instead
# VITE_WORKER_URL=https://hail-mary.martinbibb.workers.dev
# ROCKY_WORKER_URL=https://hail-mary.martinbibb.workers.dev
#
# Rocky Configuration (in wrangler.toml):
# - ROCKY_MODEL: AI model to use (default: gemini-1.5-pro)
# - ROCKY_TEMPERATURE: Response creativity 0.0-1.0 (default: 0.2)
# - ROCKY_MAX_TOKENS: Maximum response length (default: 600)
# Set these via Cloudflare Worker environment variables, not here.

# ======================
# SARAH (LLM Explanation Layer) - Optional
# ======================
# Sarah is the LLM-powered explanation layer that generates human-readable
# explanations from Rocky's deterministic facts. Sarah NEVER analyzes raw data
# directly - she only explains what Rocky has already determined.
#
# Sarah is deployed to the same Cloudflare Worker as Rocky.
# Endpoint: POST /sarah/explain
#
# Cloudflare Worker URL for Sarah service
# This is your deployed Cloudflare Worker that handles both Rocky and Sarah
# Default: https://hail-mary.martinbibb.workers.dev
# SARAH_BASE_URL=https://hail-mary.martinbibb.workers.dev
# SARAH_WORKER_URL=https://hail-mary.martinbibb.workers.dev
#
# Optional authentication token for Sarah Worker
# SARAH_WORKER_TOKEN=
#
# Path to voice notes endpoint on the Worker (default: /v1/voice-notes)
# SARAH_VOICE_NOTES_PATH=/v1/voice-notes
#
# Path to chat endpoint on the Worker (default: /v1/chat)
# SARAH_CHAT_PATH=/v1/chat
#
# Path to transcription endpoint on the Worker (default: /v1/transcribe)
# SARAH_TRANSCRIBE_PATH=/v1/transcribe
#
# Sarah Configuration (in wrangler.toml):
# - SARAH_MODEL: AI model to use (default: gemini-1.5-flash)
# - SARAH_TEMPERATURE: Response creativity 0.0-1.0 (default: 0.3)
# - SARAH_MAX_TOKENS: Maximum response length (default: 500)
# Set these via Cloudflare Worker environment variables, not here.

# ======================
# GOOGLE OAUTH (Optional - disabled by default)
# ======================
# Enable Google OAuth authentication
# ðŸ”´ IMPORTANT: Google OAuth is DISABLED by default to prevent crashes
# when credentials are not configured. Set to true only after configuring
# your Google OAuth credentials.
#
# To enable Google OAuth:
# 1. Obtain GOOGLE_CLIENT_SECRET from Google Cloud Console:
#    - Go to: https://console.cloud.google.com/apis/credentials
#    - Find your OAuth 2.0 Client ID: 1010895939308-oa69f1h1brjjdfpkum66fqhcouvcqrqc
#    - Click on it and copy the Client Secret
#    - Never commit the Client Secret to version control!
# 2. Set GOOGLE_CLIENT_SECRET below (replace the placeholder)
# 3. Set GOOGLE_AUTH_ENABLED=true
# 4. Configure redirect URIs in Google Cloud Console
# 5. Restart your application
#
# Default: false (disabled for security - must be explicitly enabled)
# GOOGLE_AUTH_ENABLED=true

# Google OAuth Client ID
GOOGLE_CLIENT_ID=1010895939308-oa69f1h1brjjdfpkum66fqhcouvcqrqc.apps.googleusercontent.com

# Google OAuth Client Secret (REQUIRED - obtain from Google Cloud Console)
# ðŸ”´ SECURITY: This is a SECRET - never commit this value to git!
# Get it from: https://console.cloud.google.com/apis/credentials
# GOOGLE_CLIENT_SECRET=REPLACE_WITH_YOUR_ACTUAL_CLIENT_SECRET

# Optional: Override the callback URL (auto-generated from BASE_URL if not set)
# The callback URL must be registered in Google Cloud Console under "Authorized redirect URIs"
# Format: https://your-domain.com/api/auth/google/callback
# GOOGLE_CALLBACK_URL=https://your-domain.com/api/auth/google/callback

# ======================
# NAS AUTHENTICATION (Optional - for local deployments only)
# ======================
# Enable NAS quick login mode (passwordless login for trusted networks)
# ðŸ”´ SECURITY WARNING: Only enable this on trusted local networks!
# Default: false (disabled)
# NAS_AUTH_MODE=true
#
# Allowed IP ranges for NAS authentication (CIDR notation, comma-separated)
# By default, only RFC1918 private networks and localhost are allowed:
#   - 127.0.0.0/8 (localhost)
#   - 10.0.0.0/8 (Private A)
#   - 172.16.0.0/12 (Private B)
#   - 192.168.0.0/16 (Private C)
#
# To customize (e.g., restrict to specific subnet):
# NAS_ALLOWED_IPS=192.168.1.0/24,10.0.0.0/8
#
# To allow single IP:
# NAS_ALLOWED_IPS=192.168.1.100/32

# ======================
# INITIAL ADMIN USER (First Run - Optional)
# ======================
# Bootstrap admin email - automatically grants admin role to this email on registration
# Use this for recovery access or to ensure a specific user always gets admin rights
# Example: BOOTSTRAP_ADMIN_EMAIL=admin@example.com
# BOOTSTRAP_ADMIN_EMAIL=

# These env vars are used to create an initial admin user on first run.
# The seed is idempotent - if the user already exists, it won't be recreated.
# 
# DEFAULT CREDENTIALS (if not set):
#   Email: admin@hailmary.local
#   Password: HailMary2024!
#
# Note: The first registered user will automatically become admin regardless of these settings.
# For production deployments, change these values!
# INITIAL_ADMIN_EMAIL=admin@example.com
# INITIAL_ADMIN_PASSWORD=your-secure-password
# INITIAL_ADMIN_NAME=Admin

# ======================
# GUEST USER (First Run - Optional)
# ======================
# These env vars are used to create a guest user on first run for demos.
# Guest users have limited access and cannot view customer/lead data.
# 
# DEFAULT CREDENTIALS (if not set):
#   Email: guest@hailmary.local
#   Password: guestpass (minimum 8 characters)
#
# To disable guest login, leave these commented out.
# GUEST_EMAIL=guest@example.com
# GUEST_PASSWORD=guestpass123
# GUEST_NAME=Guest User
